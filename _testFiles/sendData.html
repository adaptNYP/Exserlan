<!DOCTYPE html>
<html lang="en">

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="JS/testdata.js"></script>
    <script>
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        console.log(data)
        async function sendData() {
            for (var i = 0; i < data.length; i++) {
                await sleep(data[i]["interlearner delay in seconds"] * 1000);
                await sendDataPromise(data[i]);
                console.log("Sent", data[i])
            }
        }
        function sendDataPromise(data) {
            return new Promise(resolve =>
                $.ajax({
                    type: "POST",
                    url: "https://dxsurveyapi.azurewebsites.net/api/Survey/post/",
                    data: {
                        postId: "4ef0c037-a54a-4a3c-86ef-312cd48737bf",
                        surveyResult: JSON.stringify({
                            Code: data.Code,
                            QnLabel: data.QnLabel,
                            Name: data.Name,
                            Answer: data.Answer
                        })
                    },
                    success: () => resolve()
                })
            );
        }
    </script>
</head>

<body>
    <button onclick="sendData()">Send Data</button>
</body>

</html>